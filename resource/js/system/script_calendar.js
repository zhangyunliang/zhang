var userAgent=navigator.userAgent.toLowerCase();var is_opera=userAgent.indexOf("opera")!=-1&&opera.version();var is_moz=(navigator.product=="Gecko")&&userAgent.substr(userAgent.indexOf("firefox")+8,3);var is_ie=(userAgent.indexOf("msie")!=-1&&!is_opera)&&userAgent.substr(userAgent.indexOf("msie")+5,3);var is_safari=(userAgent.indexOf("webkit")!=-1||userAgent.indexOf("safari")!=-1);function doane(a){e=a?a:window.event;if(is_ie){e.returnValue=false;e.cancelBubble=true}else{if(e){e.stopPropagation();e.preventDefault()}}}var controlid=null;var currdate=null;var startdate=null;var enddate=null;var yy=null;var mm=null;var hh=null;var ii=null;var currday=null;var addtime=false;var today=new Date();var lastcheckedyear=false;var lastcheckedmonth=false;function getposition(b){var a=new Array();a.x=b.offsetLeft;a.y=b.offsetTop;while(b=b.offsetParent){a.x+=b.offsetLeft;a.y+=b.offsetTop}return a}function winScroll(){var a=new Array();var b=x=0;if(document.documentElement&&document.documentElement.scrollTop){x=document.documentElement.scrollLeft;b=document.documentElement.scrollTop}else{if(document.body){x=document.body.scrollLeft;b=document.body.scrollTop}}a.x=x;a.y=b;return a}function loadcalendar(){var d="";d+='<div id="calendar" style="display:none; position:absolute; z-index:100000;" onclick="doane(event)">';d+='<div style="width: 210px;"><table cellspacing="0" cellpadding="0" width="100%" style="text-align: center;">';d+='<tr align="center" id="calendar_week" ><td><a href="###" onclick="refreshcalendar(yy, mm-1)" title="'+L.pre_month+'"><<</a></td><td colspan="5" style="text-align: center"><a href="###" onclick="showdiv(\'year\');doane(event)" class="dropmenu" title="'+L.c_choice_year+'" id="year"></a>&nbsp; - &nbsp;<a id="month" class="dropmenu" title="'+L.c_choice_month+'" href="###" onclick="showdiv(\'month\');doane(event)"></a></td><td><A href="###" onclick="refreshcalendar(yy, mm+1)" title="'+L.next_month+'">>></A></td></tr>';d+='<tr id="calendar_header"><td>'+L.d+"</td><td>一</td><td>二</td><td>三</td><td>四</td><td>五</td><td>六</td></tr>";for(var c=0;c<6;c++){d+="<tr>";for(var b=1;b<=7;b++){d+="<td id=d"+(c*7+b)+' height="19">0</td>'}d+="</tr>"}d+='<tr id="hourminute"><td colspan="7" align="center"><input type="text" size="2" value="" id="hour" class="txt" onKeyUp=\'this.value=this.value > 23 ? 23 : zerofill(this.value);controlid.value=controlid.value.replace(/\\d+(:\\d+)/ig, this.value+"$1")\'> '+L.point+' <input type="text" size="2" value="" id="minute" class="txt" onKeyUp=\'this.value=this.value > 59 ? 59 : zerofill(this.value);controlid.value=controlid.value.replace(/(\\d+:)\\d+/ig, "$1"+this.value)\'> '+L.minutes+"</td></tr>";d+="</table></div></div>";d+='<div id="calendar_year" onclick="doane(event)" style="display: none;z-index:100001;"><div class="col">';for(var a=2020;a>=1931;a--){d+=a!=2020&&a%10==0?'</div><div class="col">':"";d+='<a href="###" onclick="refreshcalendar('+a+", mm);document.getElementById('calendar_year').style.display='none'\"><span"+(today.getFullYear()==a?' class="calendar_today"':"")+' id="calendar_year_'+a+'">'+a+"</span></a><br />"}d+="</div></div>";d+='<div id="calendar_month" onclick="doane(event)" style="display: none;z-index:100001;">';for(var a=1;a<=12;a++){d+='<a href="###" onclick="refreshcalendar(yy, '+(a-1)+");document.getElementById('calendar_month').style.display='none'\"><span"+(today.getMonth()+1==a?' class="calendar_today"':"")+' id="calendar_month_'+a+'">'+a+(a<10?"&nbsp;":"")+" 月</span></a><br />"}d+="</div>";if(is_ie&&is_ie<7){d+='<iframe id="calendariframe" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>';d+='<iframe id="calendariframe_year" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>';d+='<iframe id="calendariframe_month" frameborder="0" style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"></iframe>'}var f=document.createElement("div");f.innerHTML=d;document.getElementById("append_parent").appendChild(f);document.onclick=function(g){document.getElementById("calendar").style.display="none";document.getElementById("calendar_year").style.display="none";document.getElementById("calendar_month").style.display="none";if(is_ie&&is_ie<7){document.getElementById("calendariframe").style.display="none";document.getElementById("calendariframe_year").style.display="none";document.getElementById("calendariframe_month").style.display="none"}};document.getElementById("calendar").onclick=function(g){doane(g);document.getElementById("calendar_year").style.display="none";document.getElementById("calendar_month").style.display="none";if(is_ie&&is_ie<7){document.getElementById("calendariframe_year").style.display="none";document.getElementById("calendariframe_month").style.display="none"}}}function parsedate(f){/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec(f);var d=(RegExp.$1&&RegExp.$1>1899&&RegExp.$1<2101)?parseFloat(RegExp.$1):today.getFullYear();var c=(RegExp.$2&&(RegExp.$2>0&&RegExp.$2<13))?parseFloat(RegExp.$2):today.getMonth()+1;var b=(RegExp.$3&&(RegExp.$3>0&&RegExp.$3<32))?parseFloat(RegExp.$3):today.getDate();var a=(RegExp.$4&&(RegExp.$4>-1&&RegExp.$4<24))?parseFloat(RegExp.$4):0;var g=(RegExp.$5&&(RegExp.$5>-1&&RegExp.$5<60))?parseFloat(RegExp.$5):0;/(\d+)\-(\d+)\-(\d+)\s*(\d*):?(\d*)/.exec("0000-00-00 00:00");return new Date(d,c-1,b,a,g)}function settime(a){document.getElementById("calendar").style.display="none";document.getElementById("calendar_month").style.display="none";if(is_ie&&is_ie<7){document.getElementById("calendariframe").style.display="none"}controlid.value=yy+"-"+zerofill(mm+1)+"-"+zerofill(a)+(addtime?" "+zerofill(document.getElementById("hour").value)+":"+zerofill(document.getElementById("minute").value):"");controlid.focus();controlid.blur()}function changePos(c){var b=getposition(c);var a=new Array();a.x=a.y=0;$("#[id*='fwin_']").get(0)?a=winScroll():"";document.getElementById("calendar").style.left=b.x+a.x+"px";document.getElementById("calendar").style.top=(b.y+a.y+20)+"px"}function showcalendar(c,f,a,d,b){controlid=f;addtime=a;startdate=d?parsedate(d):false;enddate=b?parsedate(b):false;currday=controlid.value?parsedate(controlid.value):today;hh=currday.getHours();ii=currday.getMinutes();changePos(controlid);document.getElementById("calendar").style.display="block";doane(c);refreshcalendar(currday.getFullYear(),currday.getMonth());if(lastcheckedyear!=false){document.getElementById("calendar_year_"+lastcheckedyear).className="calendar_default";document.getElementById("calendar_year_"+today.getFullYear()).className="calendar_today"}if(lastcheckedmonth!=false){document.getElementById("calendar_month_"+lastcheckedmonth).className="calendar_default";document.getElementById("calendar_month_"+(today.getMonth()+1)).className="calendar_today"}document.getElementById("calendar_year_"+currday.getFullYear()).className="calendar_checked";document.getElementById("calendar_month_"+(currday.getMonth()+1)).className="calendar_checked";document.getElementById("hourminute").style.display=addtime?"":"none";lastcheckedyear=currday.getFullYear();lastcheckedmonth=currday.getMonth()+1;if(is_ie&&is_ie<7){document.getElementById("calendariframe").style.top=document.getElementById("calendar").style.top;document.getElementById("calendariframe").style.left=document.getElementById("calendar").style.left;document.getElementById("calendariframe").style.width=document.getElementById("calendar").offsetWidth;document.getElementById("calendariframe").style.height=document.getElementById("calendar").offsetHeight;document.getElementById("calendariframe").style.display="block"}}function refreshcalendar(j,f){var c=new Date(j,f,1);var b=c.getDay();var h=c.getDate();var a=null;yy=c.getFullYear();mm=c.getMonth();document.getElementById("year").innerHTML=yy;document.getElementById("month").innerHTML=mm+1>9?(mm+1):"0"+(mm+1);for(var g=1;g<=b;g++){a=document.getElementById("d"+g);a.innerHTML="&nbsp;";a.className=""}while(c.getMonth()==mm){a=document.getElementById("d"+(h+b));a.innerHTML='<a href="###" onclick="settime('+h+');return false">'+h+"</a>";if((enddate&&c.getTime()>enddate.getTime())||(startdate&&c.getTime()<startdate.getTime())){a.className="calendar_expire"}else{a.className="calendar_default"}if(c.getFullYear()==today.getFullYear()&&c.getMonth()==today.getMonth()&&c.getDate()==today.getDate()){a.className="calendar_today";a.firstChild.title=L.today}if(c.getFullYear()==currday.getFullYear()&&c.getMonth()==currday.getMonth()&&c.getDate()==currday.getDate()){a.className="calendar_checked"}c.setDate(++h)}while(h+b<=42){a=document.getElementById("d"+(h+b));a.innerHTML="&nbsp;";h++}if(addtime){document.getElementById("hour").value=zerofill(hh);document.getElementById("minute").value=zerofill(ii)}}function showdiv(b){var a=getposition(document.getElementById(b));document.getElementById("calendar_"+b).style.left=a.x+"px";document.getElementById("calendar_"+b).style.top=(a.y+16)+"px";document.getElementById("calendar_"+b).style.display="block";if(is_ie&&is_ie<7){document.getElementById("calendariframe_"+b).style.top=document.getElementById("calendar_"+b).style.top;document.getElementById("calendariframe_"+b).style.left=document.getElementById("calendar_"+b).style.left;document.getElementById("calendariframe_"+b).style.width=document.getElementById("calendar_"+b).offsetWidth;document.getElementById("calendariframe_"+b).style.height=document.getElementById("calendar_"+b).offsetHeight;document.getElementById("calendariframe_"+b).style.display="block"}}function zerofill(a){var a=parseFloat(a.toString().replace(/(^[\s0]+)|(\s+$)/g,""));a=isNaN(a)?0:a;return(a<10?"0":"")+a.toString()}$(function(){loadcalendar();if($("#calendar").get(0)){$(window).scroll(function(){controlid!=null&&changePos(controlid)})}});